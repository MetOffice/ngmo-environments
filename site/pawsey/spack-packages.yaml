packages:
  gcc:
    buildable: False
  cce:
    buildable: False
  
#  mpi:
#    buildable: False
#    require: "cray-mpich"
#
  cray-mpich:
    buildable: False
    externals:
      - spec:   "cray-mpich@8.1.27 %aocc"
        prefix: "/opt/cray/pe/mpich/8.1.27/ofi/aocc/3.0"
        extra_attributes:
          environment:
            append_path:
              LD_LIBRARY_PATH: /opt/cray/libfabric/1.15.2.0/lib64:/opt/cray/pe/lib64:/host/lib64
      - spec:   "cray-mpich@8.1.27 %clang"
        prefix: "/opt/cray/pe/mpich/8.1.27/ofi/amd/5.0"
        extra_attributes:
          environment:
            append_path:
              LD_LIBRARY_PATH: /opt/cray/libfabric/1.15.2.0/lib64:/opt/cray/pe/lib64:/host/lib64
      - spec:   "cray-mpich@8.1.27 %cce"
        prefix: "/opt/cray/pe/mpich/8.1.27/ofi/cray/14.0"
        extra_attributes:
          environment:
            set:
              # Hijack the profiling variables to add a required lib paths
              PROFILE_POSTLIB: "-L/opt/cray/pe/cce/16.0.1/cce/x86_64/lib  -L/opt/cray/pe/gcc/12.2.0/snos/lib64"
      - spec:   "cray-mpich@8.1.27 %gcc"
        prefix: "/opt/cray/pe/mpich/8.1.27/ofi/gnu/9.1"
        extra_attributes:
          environment:
            append_path:
              LD_LIBRARY_PATH: /opt/cray/libfabric/1.15.2.0/lib64:/opt/cray/pe/lib64:/host/lib64

  netcdf-c:
    buildable: False
    require: "+mpi"
    externals:
      - spec:   "netcdf-c@4.9.0 %aocc  +mpi +parallel-netcdf"
        prefix: "/opt/cray/pe/netcdf-hdf5parallel/4.9.0.9/aocc/3.0"
      - spec:   "netcdf-c@4.9.0 %clang +mpi +parallel-netcdf"
        prefix: "/opt/cray/pe/netcdf-hdf5parallel/4.9.0.9/amd/5.0"
      - spec:   "netcdf-c@4.9.0 %cce   +mpi +parallel-netcdf"
        prefix: "/opt/cray/pe/netcdf-hdf5parallel/4.9.0.9/cray/17.0"
      - spec:   "netcdf-c@4.9.0 %gcc   +mpi +parallel-netcdf"
        prefix: "/opt/cray/pe/netcdf-hdf5parallel/4.9.0.9/gnu/12.3"

  netcdf-fortran:
    buildable: False
    externals:
      - spec:   "netcdf-fortran@4.5.3 %aocc"
        prefix: "/opt/cray/pe/netcdf-hdf5parallel/4.9.0.9/aocc/3.0"
      - spec:   "netcdf-fortran@4.5.3 %clang"
        prefix: "/opt/cray/pe/netcdf-hdf5parallel/4.9.0.9/amd/5.0"
      - spec:   "netcdf-fortran@4.5.3 %cce"
        prefix: "/opt/cray/pe/netcdf-hdf5parallel/4.9.0.9/cray/17.0"
      - spec:   "netcdf-fortran@4.5.3 %gcc"
        prefix: "/opt/cray/pe/netcdf-hdf5parallel/4.9.0.9/gnu/12.3"

  netcdf-cxx4:
    buildable: False
    externals:
      - spec:   "netcdf-cxx4@4.3.1 %aocc"
        prefix: "/opt/cray/pe/netcdf-hdf5parallel/4.9.0.9/aocc/3.0"
      - spec:   "netcdf-cxx4@4.3.1 %clang"
        prefix: "/opt/cray/pe/netcdf-hdf5parallel/4.9.0.9/amd/5.0"
      - spec:   "netcdf-cxx4@4.3.1 %cce"
        prefix: "/opt/cray/pe/netcdf-hdf5parallel/4.9.0.9/cray/17.0"
      - spec:   "netcdf-cxx4@4.3.1 %gcc"
        prefix: "/opt/cray/pe/netcdf-hdf5parallel/4.9.0.9/gnu/12.3"

  hdf5:
    buildable: False
    externals:
      - spec:   "hdf5@1.12.2 %aocc +fortran +mpi"
        prefix: "/opt/cray/pe/hdf5-parallel/1.12.2.9/aocc/3.0"
      - spec:   "hdf5@1.12.2 %clang +fortran +mpi"
        prefix: "/opt/cray/pe/hdf5-parallel/1.12.2.9/amd/5.0"
      - spec:   "hdf5@1.12.2 %cce +fortran +mpi"
        prefix: "/opt/cray/pe/hdf5-parallel/1.12.2.9/cray/17.0"
      - spec:   "hdf5@1.12.2 %gcc +fortran +mpi"
        prefix: "/opt/cray/pe/hdf5-parallel/1.12.2.9/gnu/12.3"

  # Errors building with Cray
  papi:
    require:
      - "%gcc"

  libelf:
    require:
      - "%gcc"

  serf:
    require:
      - "%gcc"
